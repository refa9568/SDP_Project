<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Command Dashboard</title>
  <style>
    :root{
      --bg: #2f3b2f;
      --panel: #556634;
      --panelAlt: #3b4a36;
      --card: #2f3f34;
      --stroke: rgba(255,255,255,.14);
      --text: #e9efd6;
      --muted: rgba(233,239,214,.72);
      --btn: #cbbd7c;
      --btnText: #223017;
      --btnDark: #2e3b32;
      --green: #23b35a;
      --amber: #d6a64f;
      --blue: #2d6ef7;
      --red: #d94a3a;
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      min-height:100vh;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Helvetica Neue", sans-serif;
      background: radial-gradient(1200px 700px at 20% -10%, rgba(255,255,255,.06), transparent 55%),
                  radial-gradient(900px 600px at 85% 30%, rgba(0,0,0,.22), transparent 55%),
                  var(--bg);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
    }

    .wrap{
      max-width: 1180px;
      margin: 22px auto 40px;
      padding: 0 18px;
    }

    /* header */
    .topbar{
      background: var(--panel);
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: 18px 18px;
      box-shadow: 0 12px 26px rgba(0,0,0,.25);
    }
    .topbar-row{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap: 16px;
    }
    .title h1{
      margin:0;
      font-size: 30px;
      font-weight: 900;
      letter-spacing:.2px;
    }
    .title p{
      margin:6px 0 0;
      color: var(--muted);
      font-size: 15px;
      font-weight: 700;
    }
    .top-actions{
      display:flex;
      align-items:center;
      gap: 12px;
      margin-top: 4px;
    }
    .btn{
      border:1px solid rgba(255,255,255,.16);
      border-radius: 8px;
      padding: 10px 16px;
      font-weight: 900;
      cursor:pointer;
      background: rgba(0,0,0,.20);
      color: var(--text);
      box-shadow: 0 8px 18px rgba(0,0,0,.22);
      transition: transform .20s ease, box-shadow .20s ease, background-color .18s ease;
    }
    .btn.light{ background: var(--btn); color: var(--btnText); border-color: rgba(0,0,0,.25); }
    .btn.dark{ background: var(--btnDark); color: rgba(233,239,214,.88); }
    .btn:hover, .btn:focus{ transform: translateY(-3px); box-shadow:0 18px 30px rgba(0,0,0,.28); }

    /* stat cards */
    .stats{
      margin-top: 16px;
      display:grid;
      grid-template-columns: repeat(5, minmax(150px, 1fr));
      gap: 14px;
    }
    .stat{
      background: linear-gradient(180deg, rgba(255,255,255,.03), rgba(0,0,0,.08)), var(--card);
      border: 1px solid var(--stroke);
      border-radius: 10px;
      padding: 14px 14px;
      display:flex;
      flex-direction:column;
      gap: 6px;
      box-shadow: 0 10px 20px rgba(0,0,0,.18);
      position:relative;
      overflow:hidden;
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
    }
    .stat::before{
      content:"";
      position:absolute;
      inset: 0 0 auto 0;
      height: 12px;
      background: rgba(0,0,0,.16);
    }
    .stat:hover{ transform: translateY(-6px); box-shadow: 0 22px 40px rgba(0,0,0,.30); border-color: rgba(255,255,255,.20); }
    .stat .label{ font-weight: 900; color: var(--muted); letter-spacing:.15px; }
    .stat .num{ font-size: 26px; font-weight: 900; }
    .stat.present{ outline: 2px solid rgba(35,179,90,.55); }
    .stat.leave{ outline: 2px solid rgba(214,166,79,.55); }
    .stat.duty{ outline: 2px solid rgba(45,110,247,.55); }
    .stat.awol{ outline: 2px solid rgba(217,74,58,.55); }

    /* panels */
    .grid{
      margin-top: 18px;
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap: 16px;
    }
    .panel{
      background: var(--panel);
      border: 1px solid var(--stroke);
      border-radius: 12px;
      padding: 14px;
      box-shadow: 0 12px 22px rgba(0,0,0,.22);
      transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
      min-height: 280px;
      position:relative;
    }
    .panel:hover{ transform: translateY(-6px); box-shadow: 0 24px 50px rgba(0,0,0,.34); border-color: rgba(255,255,255,.18); }
    .panel-head{
      display:flex;
      align-items:center;
      gap: 10px;
      margin-bottom: 10px;
      font-weight: 900;
      letter-spacing:.15px;
    }
    .panel-head .mini{
      width: 32px; height: 32px;
      border-radius: 10px;
      display:grid; place-items:center;
      background: rgba(0,0,0,.16);
      border: 1px solid rgba(255,255,255,.10);
    }

    /* table */
    table{
      width:100%;
      border-collapse: collapse;
      background: rgba(0,0,0,.12);
      border: 1px solid rgba(255,255,255,.12);
      border-radius: 10px;
      overflow:hidden;
    }
    thead th{
      text-align:left;
      padding: 10px 12px;
      font-weight: 900;
      font-size: 13px;
      color: rgba(233,239,214,.76);
      border-bottom: 1px solid rgba(255,255,255,.12);
    }
    tbody td{
      padding: 10px 12px;
      border-bottom: 1px solid rgba(255,255,255,.08);
      font-weight: 700;
      color: rgba(233,239,214,.90);
    }
    tbody tr:hover{ background: rgba(255,255,255,.04); }
    .pill{
      display:inline-flex;
      align-items:center;
      padding: 8px 10px;
      border-radius: 8px;
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(255,255,255,.14);
      font-weight: 900;
    }
    .tag{ font-weight: 900; }
    .tag.green{ color: var(--green); }
    .tag.amber{ color: var(--amber); }
    .tag.blue{ color: var(--blue); }
    .tag.red{ color: var(--red); }

    /* tasks list */
    .tasks{ display:flex; flex-direction:column; gap: 10px; }
    .task{
      padding: 12px;
      border-radius: 10px;
      background: var(--panelAlt);
      border: 1px solid rgba(255,255,255,.10);
      box-shadow: 0 8px 16px rgba(0,0,0,.18);
    }
    .task .title{ font-weight: 900; margin: 0 0 4px; }
    .task .meta{ color: rgba(233,239,214,.70); font-weight: 700; }

    /* bottom panels */
    .grid-bottom{
      margin-top: 16px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }
    .panel-title{
      font-weight: 900;
      margin: 0 0 10px;
      letter-spacing:.15px;
    }
    .list-btn{
      display:block;
      width:100%;
      height:54px;
      margin-bottom:12px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.26);
      color: var(--text);
      font-weight: 900;
      letter-spacing:.18px;
      cursor:pointer;
      box-shadow: 0 10px 18px rgba(0,0,0,.18);
    }
    .list-btn.black{
      background: #0f120f;
      color: var(--text);
      border-color: rgba(255,255,255,.20);
    }
    .legend{ display:flex; gap:14px; align-items:center; margin-top:10px; font-weight:900; }
    .legend .swatch{ width:14px; height:14px; border-radius:4px; display:inline-block; margin-right:6px; }
    .swatch.present{ background: var(--green); }
    .swatch.absent{ background: var(--red); }
    /* attendance chart */
    .chart{ margin-top: 6px; }
    .chart-inner{
      position:relative;
      height: 240px;
      border-radius:10px;
      border:1px solid rgba(255,255,255,.12);
      background:
        repeating-linear-gradient(to bottom, rgba(255,255,255,.08) 0 1px, transparent 1px 60px),
        repeating-linear-gradient(to right, rgba(255,255,255,.06) 0 1px, transparent 1px 64px),
        rgba(0,0,0,.12);
      overflow:hidden;
      box-shadow: inset 0 6px 12px rgba(0,0,0,.18);
      padding: 16px 18px 12px 56px; /* left space for y-axis labels */
    }
    .y-axis{ position:absolute; left:12px; top:12px; display:flex; flex-direction:column; justify-content:space-between; height: 216px; }
    .y-axis span{ color: rgba(233,239,214,.70); font-weight:900; font-size:13px; }
    .bar-rows{ display:flex; align-items:flex-end; gap: 22px; height:100%; }
    .group{ width:70px; }
    .bars{ height:100%; display:flex; align-items:flex-end; gap:8px; }
    .bar-present, .bar-absent{ width:28px; border-radius:8px; border:1px solid rgba(255,255,255,.12); box-shadow: 0 8px 14px rgba(0,0,0,.20); }
    .bar-present{ background: rgba(35,179,90,.90); }
    .bar-absent{ background: rgba(217,74,58,.90); }
    .bar-x{ text-align:center; margin-top:6px; font-weight:900; color: var(--muted); }

    /* responsive */
    @media (max-width: 1100px){
      .stats{ grid-template-columns: repeat(3, minmax(150px, 1fr)); }
      .grid{ grid-template-columns: 1fr; }
      .grid-bottom{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="wrap">

    <!-- Header -->
    <header class="topbar">
      <div class="topbar-row">
        <div class="title">
          <h1>Commanding Officer Dashboard</h1>
          <p>Battalion-Wide Command & Control Center</p>
        </div>
        <div class="top-actions">
          <button class="btn light" onclick="window.location.href='../coy_commander/report.html'">Reports</button>
          <button class="btn dark" onclick="window.location.href='../../login.html'">Logout</button>
        </div>
      </div>
    </header>

    <!-- Strength cards -->
    <section class="stats">
      <div class="stat total">
        <div class="label">Total Strength</div>
        <div class="num">450</div>
      </div>
      <div class="stat present">
        <div class="label">Present</div>
        <div class="num">361</div>
      </div>
      <div class="stat leave">
        <div class="label">On Leave</div>
        <div class="num">32</div>
      </div>
      <div class="stat duty">
        <div class="label">On Duty</div>
        <div class="num">55</div>
      </div>
      <div class="stat awol">
        <div class="label">AWOL</div>
        <div class="num">02</div>
      </div>
    </section>

    <!-- Panels -->
    <section class="grid">
      <div class="panel">
        <div class="panel-head">
          <div class="mini" aria-hidden="true">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <rect x="3" y="3" width="7" height="7" rx="1" stroke="rgba(233,239,214,.9)" stroke-width="2" fill="none"/>
              <rect x="14" y="3" width="7" height="7" rx="1" stroke="rgba(233,239,214,.9)" stroke-width="2" fill="none"/>
              <rect x="3" y="14" width="7" height="7" rx="1" stroke="rgba(233,239,214,.9)" stroke-width="2" fill="none"/>
              <rect x="14" y="14" width="7" height="7" rx="1" stroke="rgba(233,239,214,.9)" stroke-width="2" fill="none"/>
            </svg>
          </div>
          <span>Company-wise Strength Overview</span>
        </div>
        <table style="margin-top: 12px;">
          <thead>
            <tr>
              <th>Company</th>
              <th>Total</th>
              <th>Present</th>
              <th>On Leave</th>
              <th>Readiness</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="pill">Radio Company</span></td>
              <td>120</td>
              <td>98</td>
              <td>12</td>
              <td><span class="tag green">82%</span></td>
            </tr>
            <tr>
              <td><span class="pill">RR Company</span></td>
              <td>115</td>
              <td>92</td>
              <td>15</td>
              <td><span class="tag green">80%</span></td>
            </tr>
            <tr>
              <td><span class="pill">Operating Company</span></td>
              <td>110</td>
              <td>88</td>
              <td>18</td>
              <td><span class="tag amber">80%</span></td>
            </tr>
            <tr>
              <td><span class="pill">HQ Company</span></td>
              <td>105</td>
              <td>83</td>
              <td>17</td>
              <td><span class="tag amber">79%</span></td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="panel">
        <div class="panel-head">
          <div class="mini" aria-hidden="true">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
              <path d="M9 11l3 3L22 4" stroke="rgba(233,239,214,.9)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
              <path d="M21 12v7a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h11" stroke="rgba(233,239,214,.9)" stroke-width="2" stroke-linecap="round" fill="none"/>
            </svg>
          </div>
          <span>Critical Actions Required</span>
        </div>
        <div class="tasks">
          <div class="task">
            <div class="title">Battalion Readiness Check</div>
            <div class="meta">Scheduled: Today 1400 hrs</div>
          </div>
          <div class="task">
            <div class="title">Weekly Report Submission</div>
            <div class="meta">Due: Today 1700 hrs</div>
          </div>
          <div class="task">
            <div class="title">2 AWOL Cases</div>
            <div class="meta">Action required within 24 hrs</div>
          </div>
          <div class="task">
            <div class="title">Monthly Training Review</div>
            <div class="meta">Scheduled: Tomorrow 0900 hrs</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Bottom Panels -->
    <section class="grid-bottom">
      <div class="panel">
        <h3 class="panel-title">Strategic Reports & Documents</h3>
        <button class="list-btn" onclick="window.location.href='../coy_commander/report.html'">Battalion Strength Report</button>
        <button class="list-btn" onclick="window.location.href='../coy_commander/coy_reports.html'">Company Performance Reports</button>
        <button class="list-btn" onclick="window.location.href='../coy_commander/daily_employment.html'">Personnel Deployment Overview</button>
      </div>
      <div class="panel">
        <div style="display:flex; justify-content:space-between; align-items:center; gap:12px;">
          <h3 class="panel-title" style="margin:0">Unit Notice Board</h3>
          <div style="display:flex; gap:8px; align-items:center;">
            <button id="addNoticeBtn" class="btn light" style="padding:8px 12px; font-size:13px;">Add Notice</button>
          </div>
        </div>

        <div id="addNoticeForm" style="display:none; margin-top:12px; background: rgba(0,0,0,.14); border:1px solid rgba(255,255,255,.06); padding:12px; border-radius:8px;">
          <form id="noticeForm">
            <div style="display:flex; gap:8px; margin-bottom:8px;">
              <input id="noticeSender" placeholder="Sender (e.g., Adjutant)" style="flex:1; padding:8px; border-radius:6px; border:1px solid rgba(255,255,255,.08); background:transparent; color:var(--text); font-weight:700;" />
              <input id="noticeType" placeholder="Type (Notice/Order)" style="width:160px; padding:8px; border-radius:6px; border:1px solid rgba(255,255,255,.08); background:transparent; color:var(--text); font-weight:700;" />
            </div>
            <div style="margin-bottom:8px;">
              <textarea id="noticeContent" placeholder="Notice content" rows="4" style="width:100%; padding:8px; border-radius:6px; border:1px solid rgba(255,255,255,.08); background:transparent; color:var(--text); font-weight:700;"></textarea>
            </div>
            <div style="display:flex; gap:8px; justify-content:flex-end;">
              <button type="button" id="cancelNotice" class="btn dark" style="padding:8px 12px;">Cancel</button>
              <button type="submit" class="btn light" style="padding:8px 12px;">Save Notice</button>
            </div>
          </form>
        </div>

        <div id="noticeBoard" style="min-height: 180px; max-height: 300px; overflow-y: auto; background: rgba(0,0,0,.18); border: 2px dashed rgba(255,255,255,.16); border-radius: 10px; padding: 20px; margin-top:12px;">
          <!-- Notices will be loaded here -->
        </div>
      </div>
    </section>

    <script>
      // Helper: save notices array to localStorage
      function saveNotices(notices) {
        localStorage.setItem('CO_notices', JSON.stringify(notices));
      }

      // Load notices from localStorage and render (newest first)
      function loadNotices() {
        const noticeBoard = document.getElementById('noticeBoard');
        let notices = JSON.parse(localStorage.getItem('CO_notices') || '[]');

        // Sort newest first
        notices.sort((a, b) => new Date(b.date) - new Date(a.date));

        if (notices.length === 0) {
          noticeBoard.innerHTML = `
            <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 140px;">
              <div style="color: rgba(233,239,214,.50); font-weight: 700; text-align: center;">
                No new notices or reports<br>
                <span style="font-size: 13px; opacity: 0.7;">Awaiting updates from Adjutant, Coy Comd, or BSM</span>
              </div>
            </div>
          `;
        } else {
          let noticesHTML = '';
          notices.forEach((notice, index) => {
            const date = new Date(notice.date);
            const dateStr = date.toLocaleString('en-GB', {
              day: '2-digit',
              month: 'short',
              hour: '2-digit',
              minute: '2-digit'
            });

            noticesHTML += `
              <div 
                id="notice-${index}" 
                style="background: rgba(0,0,0,.25); border: 1px solid rgba(255,255,255,.12); border-radius: 8px; padding: 12px; margin-bottom: 10px; transition: all 0.2s ease;"
                onmouseover="this.style.background='rgba(0,0,0,.35)'; this.style.borderColor='rgba(255,255,255,.18)'"
                onmouseout="this.style.background='rgba(0,0,0,.25)'; this.style.borderColor='rgba(255,255,255,.12)'"
              >
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                  <div style="font-weight: 900; color: #23b35a; cursor: pointer;" onclick="toggleNotice(${index})">
                    ${notice.type || 'Notice'} from ${notice.sender || 'Unknown'}
                  </div>
                  <div style="display: flex; gap: 10px; align-items: center;">
                    <div style="font-size: 11px; color: rgba(233,239,214,.50);">${dateStr}</div>
                    <button 
                      onclick="deleteNotice(${index}); event.stopPropagation();" 
                      style="background: #d94a3a; border: none; color: white; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-weight: 700; font-size: 11px;"
                      onmouseover="this.style.background='#c2332a'" 
                      onmouseout="this.style.background='#d94a3a'"
                    >Delete</button>
                  </div>
                </div>
                <div 
                  id="notice-content-${index}" 
                  style="display: none; color: rgba(233,239,214,.90); font-weight: 600; white-space: pre-wrap; margin-top: 10px; padding-top: 10px; border-top: 1px solid rgba(255,255,255,.08); cursor: pointer;"
                  onclick="toggleNotice(${index})"
                >
                  ${notice.content}
                </div>
                <div style="color: rgba(233,239,214,.50); font-size: 12px; font-weight: 700; margin-top: 6px; cursor: pointer;" onclick="toggleNotice(${index})">
                  Click to ${index === 0 ? 'open' : 'view'}
                </div>
              </div>
            `;
          });
          noticeBoard.innerHTML = noticesHTML;
        }
      }

      // Toggle notice content visibility
      function toggleNotice(index) {
        const contentDiv = document.getElementById(`notice-content-${index}`);
        if (!contentDiv) return;
        contentDiv.style.display = contentDiv.style.display === 'none' ? 'block' : 'none';
      }

      // Delete notice
      function deleteNotice(index) {
        if (confirm('Are you sure you want to delete this notice?')) {
          let notices = JSON.parse(localStorage.getItem('CO_notices') || '[]');
          // We display notices sorted newest-first, so index maps directly to the sorted array
          notices.sort((a, b) => new Date(b.date) - new Date(a.date));
          notices.splice(index, 1);
          saveNotices(notices);
          loadNotices();
        }
      }

      // Show / hide add form
      function showAddForm() { document.getElementById('addNoticeForm').style.display = 'block'; document.getElementById('noticeSender').focus(); }
      function hideAddForm() { document.getElementById('addNoticeForm').style.display = 'none'; document.getElementById('noticeForm').reset(); }

      // Add new notice from form
      function addNoticeFromForm(e) {
        e && e.preventDefault();
        const sender = document.getElementById('noticeSender').value.trim() || 'Adjutant';
        const type = document.getElementById('noticeType').value.trim() || 'Notice';
        const content = document.getElementById('noticeContent').value.trim();
        if (!content) { alert('Please enter notice content'); return; }

        let notices = JSON.parse(localStorage.getItem('CO_notices') || '[]');
        // Add newest at start
        notices.unshift({ date: new Date().toISOString(), sender, type, content });
        saveNotices(notices);
        hideAddForm();
        loadNotices();
      }

      // Setup event handlers
      window.addEventListener('DOMContentLoaded', () => {
        document.getElementById('addNoticeBtn').addEventListener('click', showAddForm);
        document.getElementById('cancelNotice').addEventListener('click', hideAddForm);
        document.getElementById('noticeForm').addEventListener('submit', addNoticeFromForm);
        loadNotices();
      });

      // Reload notices every 30 seconds
      setInterval(loadNotices, 30000);
    </script>

  </div>
</body>
</html>